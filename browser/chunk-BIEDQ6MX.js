import{P as s}from"./chunk-ENVQAO3F.js";var i=class a{users=[{username:"user1",email:"user1@example.com",password:"password123",role:"user"},{username:"user2",email:"user2@example.com",password:"password456",role:"admin"}];constructor(){}getUserByUsername(e,r){return this.users.find(t=>t.username===e&&t.email===r)}login(e,r,t){let n=this.users.find(o=>o.username===e&&o.email===r&&o.password===t);if(n){let o=this.createToken(n);return localStorage.setItem("token",o),localStorage.setItem("username",n.username),o}return null}createToken(e){let r={alg:"HS256",typ:"JWT"},t={username:e.username,role:e.role},n=btoa(JSON.stringify(r)),o=btoa(JSON.stringify(t));return`${n}.${o}.signature`}isLoggedIn(){return localStorage.getItem("token")!==null}isAdmin(){let e=localStorage.getItem("token");return e?this.decodeToken(e)?.role==="admin":!1}decodeToken(e){let r=e.split(".")[1],t=atob(r);return JSON.parse(t)}logout(){localStorage.removeItem("token")}static \u0275fac=function(r){return new(r||a)};static \u0275prov=s({token:a,factory:a.\u0275fac,providedIn:"root"})};export{i as a};
